{"version":3,"sources":["../../../../components/game-session.tsx/__nextjs-internal-proxy.mjs","../../../../app/game/%5BgameId%5D/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const GameSession = registerClientReference(\n    function() { throw new Error(\"Attempted to call GameSession() from the server but GameSession is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/game-session.tsx\",\n    \"GameSession\",\n);\n","import { createClient } from \"@/lib/supabase/server\"\nimport { notFound } from \"next/navigation\"\nimport { GameSession } from \"@/components/game-session\"\n\nexport default async function GamePage({\n  params\n}: {\n  params: Promise<{ gameId: string }>\n}) {\n  const { gameId } = await params\n  const supabase = await createClient()\n  const { data: game } = await supabase\n    .from(\"games\")\n    .select(\"id, short_code, host_id, description, status\")\n    .eq(\"id\", gameId)\n    .single()\n\n  if (!game) notFound()\n\n  const { data: players } = await supabase\n    .from(\"game_players\")\n    .select(\"user_id, status, cash_in, cash_out, display_name\")\n    .eq(\"game_id\", gameId)\n\n  const { data: { user } } = await supabase.auth.getUser()\n  if (!user) notFound()\n\n  const isHost = game.host_id === user.id\n  const myRow = players?.find((p) => p.user_id === user.id)\n  if (!myRow && !isHost) notFound()\n\n  const userIds = [...new Set((players ?? []).map((p) => p.user_id))]\n  const { data: profiles } = await supabase\n    .from(\"profiles\")\n    .select(\"id, display_name, venmo_handle\")\n    .in(\"id\", userIds)\n\n  const profileMap = new Map((profiles ?? []).map((p) => [p.id, p]))\n\n  const initialPlayers = (players ?? []).map((p) => {\n    const prof = profileMap.get(p.user_id)\n    return {\n      user_id: p.user_id,\n      status: p.status,\n      cash_in: Number(p.cash_in),\n      cash_out: Number(p.cash_out),\n      display_name: p.display_name ?? prof?.display_name ?? null,\n      venmo_handle: prof?.venmo_handle ?? null\n    }\n  })\n\n  return (\n    <GameSession\n      game={{\n        id: game.id,\n        short_code: game.short_code,\n        host_id: game.host_id,\n        description: game.description,\n        status: game.status\n      }}\n      initialPlayers={initialPlayers}\n      currentUserId={user.id}\n      isHost={isHost}\n    />\n  )\n}\n"],"names":[],"mappings":"ibAEO,IAAM,EAAc,CAAA,EAAA,AAD3B,EAAA,CAAA,CAAA,OAC2B,uBAAA,AAAuB,EAC9C,WAAa,MAAM,AAAI,MAAM,oOAAsO,EACnQ,4DACA,kEAHG,IAAM,EAAc,CAAA,EAAA,AAD3B,EAAA,CAAA,CAAA,OAC2B,uBAAA,AAAuB,EAC9C,WAAa,MAAM,AAAI,MAAM,oOAAsO,EACnQ,wCACA,kHCLJ,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEe,eAAe,EAAS,QACrC,CAAM,CAGP,EACC,GAAM,QAAE,CAAM,CAAE,CAAG,MAAM,EACnB,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAC7B,CAAE,KAAM,CAAI,CAAE,CAAG,MAAM,EAC1B,IAAI,CAAC,SACL,MAAM,CAAC,gDACP,EAAE,CAAC,KAAM,GACT,MAAM,EAEL,CAAC,GAAM,CAAA,EAAA,EAAA,QAAA,AAAQ,IAEnB,GAAM,CAAE,KAAM,CAAO,CAAE,CAAG,MAAM,EAC7B,IAAI,CAAC,gBACL,MAAM,CAAC,oDACP,EAAE,CAAC,UAAW,GAEX,CAAE,KAAM,MAAE,CAAI,CAAE,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,OAAO,EAClD,CAAC,GAAM,CAAA,EAAA,EAAA,QAAA,AAAQ,IAEnB,IAAM,EAAS,EAAK,OAAO,GAAK,EAAK,EAAE,AAEnC,CADU,AACT,GADkB,KAAK,AAAC,CACf,EADqB,EAAE,OAAO,GAAK,EAAK,EAAE,GACzC,GAAQ,CAAA,EAAA,EAAA,QAAA,AAAQ,IAE/B,IAAM,EAAU,IAAI,IAAI,IAAI,CAAC,GAAW,EAAA,AAAE,EAAE,GAAG,CAAC,AAAC,GAAM,EAAE,OAAO,GAAG,CAC7D,CAAE,KAAM,CAAQ,CAAE,CAAG,MAAM,EAC9B,IAAI,CAAC,YACL,MAAM,CAAC,kCACP,EAAE,CAAC,KAAM,GAEN,EAAa,IAAI,IAAI,CAAC,GAAY,EAAA,AAAE,EAAE,GAAG,CAAC,AAAC,GAAM,CAAC,EAAE,EAAE,CAAE,EAAE,GAE1D,EAAiB,CAAC,GAAW,EAAA,AAAE,EAAE,GAAG,CAAC,AAAC,IAC1C,IAAM,EAAO,EAAW,GAAG,CAAC,EAAE,OAAO,EACrC,MAAO,CACL,QAAS,EAAE,OAAO,CAClB,OAAQ,EAAE,MAAM,CAChB,QAAS,OAAO,EAAE,OAAO,EACzB,SAAU,OAAO,EAAE,QAAQ,EAC3B,aAAc,EAAE,YAAY,EAAI,GAAM,cAAgB,KACtD,aAAc,GAAM,cAAgB,IACtC,CACF,GAEA,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CACV,KAAM,CACJ,GAAI,EAAK,EAAE,CACX,WAAY,EAAK,UAAU,CAC3B,QAAS,EAAK,OAAO,CACrB,YAAa,EAAK,WAAW,CAC7B,OAAQ,EAAK,MAAM,AACrB,EACA,eAAgB,EAChB,cAAe,EAAK,EAAE,CACtB,OAAQ,GAGd","ignoreList":[0]}